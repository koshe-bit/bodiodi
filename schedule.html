<!-- ====== BODIODI: Rolling 7-Day Schedule (Single Chunk) ====== -->
<section class="bodi-schedule">
  <header class="bodi-schedule__head">
    <h1 class="h2">Schedule</h1>
    <p class="body bodi-schedule__sub">Rolling 7-day view. Reserve your spot in seconds.</p>
  </header>

  <div id="bodiSchedule" class="bodi-schedule__list" aria-live="polite"></div>

  <div class="bodi-schedule__foot">
    <a class="btn primary" href="https://bodiodi.com/signup.html">Reserve a class</a>
  </div>
</section>

<style>
  /* ====== Schedule styles that follow your global system ====== */
  .bodi-schedule{
    width: var(--container);
    margin: 0 auto;
    padding: var(--space-6) 0;
  }

  .bodi-schedule__head{
    display: grid;
    gap: .5rem;
    margin-bottom: var(--space-3);
  }

  .bodi-schedule__sub{
    max-width: 60ch;
    opacity: .82;
  }

  .bodi-schedule__list{
    display: grid;
    gap: var(--space-2);
  }

  /* Day card */
  .bodi-day{
    border-radius: 18px;
    border: 1px solid rgba(0,0,0,.08);
    background:
      radial-gradient(900px 500px at 20% 0%, rgba(246,227,218,0.35) 0%, transparent 55%),
      radial-gradient(700px 500px at 95% 0%, rgba(131,155,133,0.18) 0%, transparent 60%),
      rgba(255,255,255,.72);
    backdrop-filter: blur(6px);
    padding: 14px;
  }

  .bodi-day__head{
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    gap: 12px;
    padding-bottom: 10px;
    margin-bottom: 10px;
    border-bottom: 1px solid rgba(0,0,0,.08);
  }

  .bodi-day__label{
    margin: 0;
    font-family: var(--font-head);
    font-weight: 700;
    letter-spacing: -.01em;
    color: var(--sage-dark);
    font-size: 1.02rem;
  }

  .bodi-day__date{
    margin: 0;
    font-family: var(--font-head);
    font-weight: 500;
    opacity: .75;
    font-size: .95rem;
  }

  /* Items list */
  .bodi-day__items{
    display: grid;
    gap: 10px;
  }

  .bodi-item{
    display: grid;
    grid-template-columns: 1fr auto;
    align-items: center;
    gap: 12px;
    padding: 12px 12px;
    border-radius: 16px;
    background: rgba(255,255,255,.72);
    border: 1px solid rgba(0,0,0,.08);
  }

  .bodi-item__text{
    min-width: 0;
  }

  .bodi-item__class{
    display: inline-block;
    font-family: var(--font-head);
    font-weight: 700;
    color: var(--fg);
    text-decoration: none;
    letter-spacing: -.01em;
  }

  .bodi-item__class:hover{
    text-decoration: underline;
    text-underline-offset: 3px;
  }

  .bodi-item__meta{
    margin-top: 3px;
    font-size: .95rem;
    opacity: .78;
    line-height: 1.35;
  }

  /* Reserve button (schedule-specific, but aligned with your btn system) */
  .bodi-item__btn{
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: .75rem 1rem;
    border-radius: 999px;
    text-decoration: none;
    font-family: var(--font-head);
    font-weight: 700;
    letter-spacing: .01em;
    color: #fff;
    background: var(--sage);
    box-shadow: 0 10px 28px rgba(131,155,133,.28);
    transition: transform .18s ease, background .18s ease, box-shadow .18s ease;
    white-space: nowrap;
  }

  .bodi-item__btn:hover{
    background: var(--sage-dark);
    transform: translateY(-1px);
    box-shadow: 0 14px 34px rgba(131,155,133,.34);
  }

  .bodi-item__btn:active{
    transform: translateY(0px);
  }

  .bodi-empty{
    padding: 8px 2px 2px;
    font-size: .95rem;
    opacity: .78;
  }

  .bodi-schedule__foot{
    margin-top: var(--space-3);
    display: flex;
    justify-content: flex-start;
  }

  /* Mobile: stack item content, full-width reserve button */
  @media (max-width: 560px){
    .bodi-day{ padding: 12px; }
    .bodi-item{
      grid-template-columns: 1fr;
      gap: 10px;
      padding: 12px;
    }
    .bodi-item__btn{
      width: 100%;
      padding: .85rem 1.1rem;
    }
  }
</style>

<script>
  /**
   * Bodiodi rolling 7-day schedule (template-driven)
   * - Renders today + next 6 days (rolling)
   * - Weekly template (same classes each week; dates roll)
   * - Class name links to classes page (no anchors)
   * - Reserve button links to signup page
   */

  (function () {
    const RESERVE_URL = "https://bodiodi.com/signup.html";
    const CLASSES_URL = "https://bodiodi.com/classes.html";

    const INSTRUCTORS = {
      nicole: "Nicole",
      sarah: "Sarah",
    };

    // day: 0=Sun ... 6=Sat
    // time: 24h "HH:MM"
    // durationMin: used for end-time display
    const TEMPLATE = [
      { day: 1, className: "Anabolix", time: "17:30", durationMin: 30, instructor: "nicole" }, // Mon 5:30p–6:00p
      { day: 3, className: "Rhythmix", time: "18:15", durationMin: 60, instructor: "nicole" }, // Wed 6:15p–7:15p
      { day: 4, className: "Anabolix", time: "18:15", durationMin: 30, instructor: "nicole" }, // Thu 6:15p–6:45p
      { day: 6, className: "Rhythmix", time: "08:30", durationMin: 60, instructor: "nicole" }, // Sat 8:30a–9:30a
      { day: 6, className: "Anabolix", time: "09:45", durationMin: 30, instructor: "nicole" }, // Sat 9:45a–10:15a
      { day: 0, className: "Kinetix",  time: "15:00", durationMin: 60, instructor: "sarah" },  // Sun 3:00p–4:00p
    ];

    const SHOW_END_TIMES = true; // set false if you want only "5:30p" (no ranges)

    const root = document.getElementById("bodiSchedule");
    if (!root) return;

    const days = buildRollingDays_(new Date(), 7);
    root.innerHTML = days.map(d => renderDay_(d, classesForDate_(d.date))).join("");

    function classesForDate_(dateObj) {
      const dow = dateObj.getDay();
      return TEMPLATE
        .filter(x => x.day === dow)
        .map(x => {
          const start = combineDateTime_(dateObj, x.time);
          const end = addMinutes_(start, x.durationMin);
          return { ...x, start, end };
        })
        .sort((a, b) => a.start - b.start);
    }

    function renderDay_(day, items) {
      const dateLabel = `${day.month}/${day.day}`;

      if (!items || items.length === 0) {
        return `
          <article class="bodi-day">
            <div class="bodi-day__head">
              <p class="bodi-day__label"><b>${escapeHtml_(day.weekday)}</b></p>
              <p class="bodi-day__date">${dateLabel}</p>
            </div>
            <div class="bodi-empty">No classes at this time, check back later</div>
          </article>
        `;
      }

      const rows = items.map(it => {
        const t1 = formatTime_(it.start);
        const t2 = formatTime_(it.end);
        const timeRange = SHOW_END_TIMES ? `${t1}–${t2}` : t1;
        const instructorName = INSTRUCTORS[it.instructor] || "Instructor";

        return `
          <div class="bodi-item">
            <div class="bodi-item__text">
              <a class="bodi-item__class" href="${CLASSES_URL}">${escapeHtml_(it.className)}</a>
              <div class="bodi-item__meta">${timeRange} with ${escapeHtml_(instructorName)}</div>
            </div>
            <a class="bodi-item__btn" href="${RESERVE_URL}">RESERVE</a>
          </div>
        `;
      }).join("");

      return `
        <article class="bodi-day">
          <div class="bodi-day__head">
            <p class="bodi-day__label"><b>${escapeHtml_(day.weekday)}</b></p>
            <p class="bodi-day__date">${dateLabel}</p>
          </div>
          <div class="bodi-day__items">${rows}</div>
        </article>
      `;
    }

    function buildRollingDays_(startDate, count) {
      const out = [];
      const base = new Date(startDate.getFullYear(), startDate.getMonth(), startDate.getDate()); // midnight local
      for (let i = 0; i < count; i++) {
        const d = new Date(base);
        d.setDate(base.getDate() + i);
        out.push({
          date: d,
          weekday: d.toLocaleDateString(undefined, { weekday: "long" }),
          month: d.getMonth() + 1,
          day: d.getDate(),
        });
      }
      return out;
    }

    function combineDateTime_(dateObj, hhmm) {
      const [hh, mm] = hhmm.split(":").map(Number);
      return new Date(dateObj.getFullYear(), dateObj.getMonth(), dateObj.getDate(), hh, mm, 0, 0);
    }

    function addMinutes_(dateObj, minutes) {
      const d = new Date(dateObj);
      d.setMinutes(d.getMinutes() + (Number(minutes) || 0));
      return d;
    }

    // Format like 5:30p / 8:30a (matches your examples)
    function formatTime_(dateObj) {
      let h = dateObj.getHours();
      const m = dateObj.getMinutes();
      const am = h < 12;
      const suffix = am ? "a" : "p";
      h = h % 12;
      if (h === 0) h = 12;
      return `${h}:${String(m).padStart(2, "0")}${suffix}`;
    }

    function escapeHtml_(s) {
      return String(s || "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }
  })();
</script>
<!-- ====== /BODIODI: Rolling 7-Day Schedule ====== -->
